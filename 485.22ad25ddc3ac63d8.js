var he=Object.defineProperty,pe=Object.defineProperties,ye=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,_e=(h,g,i)=>g in h?he(h,g,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[g]=i,te=(h,g)=>{for(var i in g||(g={}))de.call(g,i)&&_e(h,i,g[i]);if(ae)for(var i of ae(g))fe.call(g,i)&&_e(h,i,g[i]);return h},ue=(h,g)=>pe(h,ye(g)),le=(h,g)=>{var i={};for(var n in h)de.call(h,n)&&g.indexOf(n)<0&&(i[n]=h[n]);if(null!=h&&ae)for(var n of ae(h))g.indexOf(n)<0&&fe.call(h,n)&&(i[n]=h[n]);return i};(self.webpackChunkdocs_app_ng=self.webpackChunkdocs_app_ng||[]).push([[485],{318:(h,g,i)=>{var n=i(6432);function d(t){var e,r;function w(D,P){try{var y=t[D](P),u=y.value,p=u instanceof n;Promise.resolve(p?u.wrapped:u).then(function(O){p?w("return"===D?"return":"next",O):b(y.done?"return":"normal",O)},function(O){w("throw",O)})}catch(O){b("throw",O)}}function b(D,P){switch(D){case"return":e.resolve({value:P,done:!0});break;case"throw":e.reject(P);break;default:e.resolve({value:P,done:!1})}(e=e.next)?w(e.key,e.arg):r=null}this._invoke=function(D,P){return new Promise(function(y,u){var p={key:D,arg:P,resolve:y,reject:u,next:null};r?r=r.next=p:(e=r=p,w(D,P))})},"function"!=typeof t.return&&(this.return=void 0)}d.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},d.prototype.next=function(t){return this._invoke("next",t)},d.prototype.throw=function(t){return this._invoke("throw",t)},d.prototype.return=function(t){return this._invoke("return",t)},h.exports=d,h.exports.default=h.exports,h.exports.__esModule=!0},6432:h=>{h.exports=function(i){this.wrapped=i},h.exports.default=h.exports,h.exports.__esModule=!0},3966:h=>{function i(n){function d(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then(function(r){return{value:r,done:e}})}return(i=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return d(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):d(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):d(r.apply(this.s,arguments))}},new i(n)}h.exports=function(n){var d,t,e,r=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,e=Symbol.iterator);r--;){if(t&&null!=(d=n[t]))return d.call(n);if(e&&null!=(d=n[e]))return new i(d.call(n));t="@@asyncIterator",e="@@iterator"}throw new TypeError("Object is not async iterable")},h.exports.default=h.exports,h.exports.__esModule=!0},7630:(h,g,i)=>{var n=i(6432);h.exports=function(t){return new n(t)},h.exports.default=h.exports,h.exports.__esModule=!0},2970:(h,g,i)=>{var n=i(318);h.exports=function(t){return function(){return new n(t.apply(this,arguments))}},h.exports.default=h.exports,h.exports.__esModule=!0},451:(h,g,i)=>{"use strict";i.a(h,async n=>{i.d(g,{iw:()=>t.iw});var d=i(684),t=i(952),e=n([d]);d=(e.then?await e:e)[0],(0,t.oT)(d)})},952:(h,g,i)=>{"use strict";let n;function d(l){n=l}i.d(g,{oT:()=>d,iw:()=>oe,ug:()=>G,XP:()=>V,YP:()=>B,qt:()=>$,hd:()=>J,FO:()=>Z,Or:()=>F}),h=i.hmd(h);const t=new Array(128).fill(void 0);function e(l){return t[l]}t.push(void 0,null,!0,!1);let r=t.length;function w(l){const f=e(l);return function(l){l<132||(t[l]=r,r=l)}(l),f}let b=0,D=null;function P(){return(null===D||0===D.byteLength)&&(D=new Uint8Array(n.memory.buffer)),D}let u=new("undefined"==typeof TextEncoder?(0,h.require)("util").TextEncoder:TextEncoder)("utf-8");const p="function"==typeof u.encodeInto?function(l,f){return u.encodeInto(l,f)}:function(l,f){const v=u.encode(l);return f.set(v),{read:l.length,written:v.length}};function O(l,f,v){if(void 0===v){const N=u.encode(l),z=f(N.length);return P().subarray(z,z+N.length).set(N),b=N.length,z}let x=l.length,L=f(x);const M=P();let R=0;for(;R<x;R++){const N=l.charCodeAt(R);if(N>127)break;M[L+R]=N}if(R!==x){0!==R&&(l=l.slice(R)),L=v(L,x,x=R+3*l.length);const N=P().subarray(L+R,L+x);R+=p(l,N).written}return b=R,L}let E=null;function _(){return(null===E||0===E.byteLength)&&(E=new Int32Array(n.memory.buffer)),E}let a=new("undefined"==typeof TextDecoder?(0,h.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});function s(l,f){return a.decode(P().subarray(l,l+f))}function o(l){r===t.length&&t.push(t.length+1);const f=r;return r=t[f],t[f]=l,f}a.decode();let m=null;function I(){return(null===m||0===m.byteLength)&&(m=new Uint32Array(n.memory.buffer)),m}function C(l,f){return I().subarray(l/4,l/4+f)}function X(l,f){return P().subarray(l/1,l/1+f)}function oe(l,f){try{const M=n.__wbindgen_add_to_stack_pointer(-16),R=O(l,n.__wbindgen_export_0,n.__wbindgen_export_1);n.get_encoding(M,R,b,o(f));var v=_()[M/4+0],x=_()[M/4+1];if(_()[M/4+2])throw w(x);return S.__wrap(v)}finally{n.__wbindgen_add_to_stack_pointer(16)}}function K(l,f){try{return l.apply(this,f)}catch(v){n.__wbindgen_export_3(o(v))}}class S{static __wrap(f){const v=Object.create(S.prototype);return v.ptr=f,v}__destroy_into_raw(){const f=this.ptr;return this.ptr=0,f}free(){const f=this.__destroy_into_raw();n.__wbg_tiktoken_free(f)}constructor(f,v,x){const L=O(f,n.__wbindgen_export_0,n.__wbindgen_export_1),M=b,R=O(x,n.__wbindgen_export_0,n.__wbindgen_export_1),N=b,z=n.tiktoken_new(L,M,o(v),R,N);return S.__wrap(z)}get name(){try{const x=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_name(x,this.ptr);var f=_()[x/4+0],v=_()[x/4+1];let L;return 0!==f&&(L=s(f,v).slice(),n.__wbindgen_export_2(f,1*v)),L}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode(f,v,x){try{const j=n.__wbindgen_add_to_stack_pointer(-16),ne=O(f,n.__wbindgen_export_0,n.__wbindgen_export_1);n.tiktoken_encode(j,this.ptr,ne,b,o(v),o(x));var L=_()[j/4+0],M=_()[j/4+1],R=_()[j/4+2];if(_()[j/4+3])throw w(R);var z=C(L,M).slice();return n.__wbindgen_export_2(L,4*M),z}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_ordinary(f){try{const M=n.__wbindgen_add_to_stack_pointer(-16),R=O(f,n.__wbindgen_export_0,n.__wbindgen_export_1);n.tiktoken_encode_ordinary(M,this.ptr,R,b);var v=_()[M/4+0],x=_()[M/4+1],L=C(v,x).slice();return n.__wbindgen_export_2(v,4*x),L}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_with_unstable(f,v,x){try{const N=n.__wbindgen_add_to_stack_pointer(-16),z=O(f,n.__wbindgen_export_0,n.__wbindgen_export_1);n.tiktoken_encode_with_unstable(N,this.ptr,z,b,o(v),o(x));var L=_()[N/4+0],M=_()[N/4+1];if(_()[N/4+2])throw w(M);return w(L)}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_single_token(f){const v=function(l,f){const v=f(1*l.length);return P().set(l,v/1),b=l.length,v}(f,n.__wbindgen_export_0);return n.tiktoken_encode_single_token(this.ptr,v,b)>>>0}decode(f){try{const M=n.__wbindgen_add_to_stack_pointer(-16),R=function(l,f){const v=f(4*l.length);return I().set(l,v/4),b=l.length,v}(f,n.__wbindgen_export_0);n.tiktoken_decode(M,this.ptr,R,b);var v=_()[M/4+0],x=_()[M/4+1],L=X(v,x).slice();return n.__wbindgen_export_2(v,1*x),L}finally{n.__wbindgen_add_to_stack_pointer(16)}}decode_single_token_bytes(f){try{const M=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_decode_single_token_bytes(M,this.ptr,f);var v=_()[M/4+0],x=_()[M/4+1],L=X(v,x).slice();return n.__wbindgen_export_2(v,1*x),L}finally{n.__wbindgen_add_to_stack_pointer(16)}}token_byte_values(){return w(n.tiktoken_token_byte_values(this.ptr))}}function G(l){w(l)}function V(l){return void 0===e(l)}function B(){return K(function(l){return o(JSON.stringify(e(l)))},arguments)}function $(l,f){const v=e(f),x="string"==typeof v?v:void 0;var L=function(l){return null==l}(x)?0:O(x,n.__wbindgen_export_0,n.__wbindgen_export_1),M=b;_()[l/4+1]=M,_()[l/4+0]=L}function J(l,f){return o(new Error(s(l,f)))}function Z(){return K(function(l,f){return o(JSON.parse(s(l,f)))},arguments)}function F(l,f){throw new Error(s(l,f))}},1485:(h,g,i)=>{"use strict";i.a(h,async n=>{i.r(g),i.d(g,{BearclawFeatureModule:()=>w});var d=i(9808),t=i(4794),e=i(1634),r=i(5e3),c=n([e]);e=(c.then?await c:c)[0];let w=(()=>{class b{}return b.\u0275fac=function(P){return new(P||b)},b.\u0275mod=r.oAB({type:b}),b.\u0275inj=r.cJS({imports:[[d.ez,t.Bz.forChild([{path:"",component:e.E,data:{CommonRouterService:{routes:[".."],seo:{title:"Bearclaw ai",keywords:"bearclaw ai chatgpt",description:"bearclaw ai chatgpt "}}}}])]]}),b})()})},1634:(h,g,i)=>{"use strict";i.a(h,async n=>{i.d(g,{E:()=>D});var d=i(9671),t=i(5885),e=i(1103),r=i(5e3),c=n([e]);e=(c.then?await c:c)[0];let D=(()=>{class P{constructor(u){this.util=u}example(){return(0,d.Z)(function*(){const p=yield new e.EN({apiKey:"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"}).sendMessage("Hello World!");console.log(p.text)})()}ngOnInit(){var u=this;return(0,d.Z)(function*(){u.example()})()}}return P.\u0275fac=function(u){return new(u||P)(r.Y36(t.fx))},P.\u0275cmp=r.Xpm({type:P,selectors:[["bearclaw-feature"]],decls:1,vars:0,template:function(u,p){1&u&&r._uU(0,"testing bearclaw chatgpt")},styles:[""]}),P})()})},6886:(h,g,i)=>{"use strict";i.d(g,{Z:()=>y});const d={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const e=new Uint8Array(16);function r(){if(!t&&(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(e)}const c=[];for(let u=0;u<256;++u)c.push((u+256).toString(16).slice(1));const y=function(u,p,O){if(d.randomUUID&&!p&&!u)return d.randomUUID();const A=(u=u||{}).random||(u.rng||r)();if(A[6]=15&A[6]|64,A[8]=63&A[8]|128,p){O=O||0;for(let E=0;E<16;++E)p[O+E]=A[E];return p}return function(u,p=0){return(c[u[p+0]]+c[u[p+1]]+c[u[p+2]]+c[u[p+3]]+"-"+c[u[p+4]]+c[u[p+5]]+"-"+c[u[p+6]]+c[u[p+7]]+"-"+c[u[p+8]]+c[u[p+9]]+"-"+c[u[p+10]]+c[u[p+11]]+c[u[p+12]]+c[u[p+13]]+c[u[p+14]]+c[u[p+15]]).toLowerCase()}(A)}},9069:h=>{"use strict";var n,g="object"==typeof Reflect?Reflect:null,i=g&&"function"==typeof g.apply?g.apply:function(s,o,m){return Function.prototype.apply.call(s,o,m)};n=g&&"function"==typeof g.ownKeys?g.ownKeys:Object.getOwnPropertySymbols?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:function(s){return Object.getOwnPropertyNames(s)};var t=Number.isNaN||function(s){return s!=s};function e(){e.init.call(this)}h.exports=e,h.exports.once=function(a,s){return new Promise(function(o,m){function I(k){a.removeListener(s,C),m(k)}function C(){"function"==typeof a.removeListener&&a.removeListener("error",I),o([].slice.call(arguments))}T(a,s,C,{once:!0}),"error"!==s&&function(a,s,o){"function"==typeof a.on&&T(a,"error",s,{once:!0})}(a,I)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var r=10;function c(a){if("function"!=typeof a)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function w(a){return void 0===a._maxListeners?e.defaultMaxListeners:a._maxListeners}function b(a,s,o,m){var I,C,k;if(c(o),void 0===(C=a._events)?(C=a._events=Object.create(null),a._eventsCount=0):(void 0!==C.newListener&&(a.emit("newListener",s,o.listener?o.listener:o),C=a._events),k=C[s]),void 0===k)k=C[s]=o,++a._eventsCount;else if("function"==typeof k?k=C[s]=m?[o,k]:[k,o]:m?k.unshift(o):k.push(o),(I=w(a))>0&&k.length>I&&!k.warned){k.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=a,Y.type=s,Y.count=k.length,function(a){console&&console.warn&&console.warn(a)}(Y)}return a}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function P(a,s,o){var m={fired:!1,wrapFn:void 0,target:a,type:s,listener:o},I=D.bind(m);return I.listener=o,m.wrapFn=I,I}function y(a,s,o){var m=a._events;if(void 0===m)return[];var I=m[s];return void 0===I?[]:"function"==typeof I?o?[I.listener||I]:[I]:o?function(a){for(var s=new Array(a.length),o=0;o<s.length;++o)s[o]=a[o].listener||a[o];return s}(I):p(I,I.length)}function u(a){var s=this._events;if(void 0!==s){var o=s[a];if("function"==typeof o)return 1;if(void 0!==o)return o.length}return 0}function p(a,s){for(var o=new Array(s),m=0;m<s;++m)o[m]=a[m];return o}function T(a,s,o,m){if("function"==typeof a.on)m.once?a.once(s,o):a.on(s,o);else{if("function"!=typeof a.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a);a.addEventListener(s,function I(C){m.once&&a.removeEventListener(s,I),o(C)})}}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(a){if("number"!=typeof a||a<0||t(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");r=a}}),e.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(s){if("number"!=typeof s||s<0||t(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this},e.prototype.getMaxListeners=function(){return w(this)},e.prototype.emit=function(s){for(var o=[],m=1;m<arguments.length;m++)o.push(arguments[m]);var I="error"===s,C=this._events;if(void 0!==C)I=I&&void 0===C.error;else if(!I)return!1;if(I){var k;if(o.length>0&&(k=o[0]),k instanceof Error)throw k;var Y=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw Y.context=k,Y}var X=C[s];if(void 0===X)return!1;if("function"==typeof X)i(X,this,o);else{var oe=X.length,U=p(X,oe);for(m=0;m<oe;++m)i(U[m],this,o)}return!0},e.prototype.on=e.prototype.addListener=function(s,o){return b(this,s,o,!1)},e.prototype.prependListener=function(s,o){return b(this,s,o,!0)},e.prototype.once=function(s,o){return c(o),this.on(s,P(this,s,o)),this},e.prototype.prependOnceListener=function(s,o){return c(o),this.prependListener(s,P(this,s,o)),this},e.prototype.off=e.prototype.removeListener=function(s,o){var m,I,C,k,Y;if(c(o),void 0===(I=this._events))return this;if(void 0===(m=I[s]))return this;if(m===o||m.listener===o)0==--this._eventsCount?this._events=Object.create(null):(delete I[s],I.removeListener&&this.emit("removeListener",s,m.listener||o));else if("function"!=typeof m){for(C=-1,k=m.length-1;k>=0;k--)if(m[k]===o||m[k].listener===o){Y=m[k].listener,C=k;break}if(C<0)return this;0===C?m.shift():function(a,s){for(;s+1<a.length;s++)a[s]=a[s+1];a.pop()}(m,C),1===m.length&&(I[s]=m[0]),void 0!==I.removeListener&&this.emit("removeListener",s,Y||o)}return this},e.prototype.removeAllListeners=function(s){var o,m,I;if(void 0===(m=this._events))return this;if(void 0===m.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==m[s]&&(0==--this._eventsCount?this._events=Object.create(null):delete m[s]),this;if(0===arguments.length){var k,C=Object.keys(m);for(I=0;I<C.length;++I)"removeListener"!==(k=C[I])&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(o=m[s]))this.removeListener(s,o);else if(void 0!==o)for(I=o.length-1;I>=0;I--)this.removeListener(s,o[I]);return this},e.prototype.listeners=function(s){return y(this,s,!0)},e.prototype.rawListeners=function(s){return y(this,s,!1)},e.listenerCount=function(a,s){return"function"==typeof a.listenerCount?a.listenerCount(s):u.call(a,s)},e.prototype.listenerCount=u,e.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},8683:(h,g)=>{g.stringify=function i(n){if(void 0===n)return n;if(n&&Buffer.isBuffer(n))return JSON.stringify(":base64:"+n.toString("base64"));if(n&&n.toJSON&&(n=n.toJSON()),n&&"object"==typeof n){var d="",t=Array.isArray(n);d=t?"[":"{";var e=!0;for(var r in n){var c="function"==typeof n[r]||!t&&void 0===n[r];Object.hasOwnProperty.call(n,r)&&!c&&(e||(d+=","),e=!1,t?d+=null==n[r]?"null":i(n[r]):void 0!==n[r]&&(d+=i(r)+":"+i(n[r])))}return d+(t?"]":"}")}return"string"==typeof n?JSON.stringify(/^:/.test(n)?":"+n:n):void 0===n?"null":JSON.stringify(n)},g.parse=function(i){return JSON.parse(i,function(n,d){return"string"==typeof d?/^:base64:/.test(d)?Buffer.from(d.substring(8),"base64"):/^:/.test(d)?d.substring(1):d:d})}},5048:(h,g,i)=>{"use strict";var n=i(4981).default,d=i(7630).default,t=i(2970).default,e=i(3966).default;const r=i(9069),c=i(8683),b=["sqlite","postgres","mysql","mongo","redis","tiered"];h.exports=class extends r{constructor(y,O={}){var A=O,{emitErrors:u=!0}=A,p=le(A,["emitErrors"]);if(super(),this.opts=te(te({namespace:"keyv",serialize:c.stringify,deserialize:c.parse},"string"==typeof y?{uri:y}:y),p),!this.opts.store){const _=te({},this.opts);this.opts.store=(P=>{const y={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(P.adapter||P.uri){const u=P.adapter||/^[^:+]*/.exec(P.uri)[0];return new(i(3196)(y[u]))(P)}return new Map})(_)}if(this.opts.compression){const _=this.opts.compression;this.opts.serialize=_.serialize.bind(_),this.opts.deserialize=_.deserialize.bind(_)}"function"==typeof this.opts.store.on&&u&&this.opts.store.on("error",_=>this.emit("error",_)),this.opts.store.namespace=this.opts.namespace;const E=_=>t(function*(){var s,T=!1,a=!1;try{for(var m,o=e("function"==typeof _?_(this.opts.store.namespace):_);T=!(m=yield d(o.next())).done;T=!1){const[I,C]=m.value,k=this.opts.deserialize(C);if(!this.opts.store.namespace||I.includes(this.opts.store.namespace)){if("number"==typeof k.expires&&Date.now()>k.expires){this.delete(I);continue}yield[this._getKeyUnprefix(I),k.value]}}}catch(I){a=!0,s=I}finally{try{T&&null!=o.return&&(yield d(o.return()))}finally{if(a)throw s}}});"function"==typeof this.opts.store[Symbol.iterator]&&this.opts.store instanceof Map?this.iterator=E(this.opts.store):"function"==typeof this.opts.store.iterator&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=E(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return b.includes(this.opts.store.opts.dialect)||b.findIndex(y=>this.opts.store.opts.url.includes(y))>=0}_getKeyPrefix(y){return`${this.opts.namespace}:${y}`}_getKeyPrefixArray(y){return y.map(u=>`${this.opts.namespace}:${u}`)}_getKeyUnprefix(y){return y.split(":").splice(1).join(":")}get(y,u){const{store:p}=this.opts,O=Array.isArray(y),A=O?this._getKeyPrefixArray(y):this._getKeyPrefix(y);if(O&&void 0===p.getMany){const E=[];for(const _ of A)E.push(Promise.resolve().then(()=>p.get(_)).then(T=>"string"==typeof T||this.opts.compression?this.opts.deserialize(T):T).then(T=>{if(null!=T)return"number"==typeof T.expires&&Date.now()>T.expires?this.delete(_).then(()=>{}):u&&u.raw?T:T.value}));return Promise.allSettled(E).then(_=>{const T=[];for(const a of _)T.push(a.value);return T})}return Promise.resolve().then(()=>O?p.getMany(A):p.get(A)).then(E=>"string"==typeof E||this.opts.compression?this.opts.deserialize(E):E).then(E=>{if(null!=E){if(O){const _=[];for(let T of E)"string"==typeof T&&(T=this.opts.deserialize(T)),null!=T?"number"==typeof T.expires&&Date.now()>T.expires?(this.delete(y).then(()=>{}),_.push(void 0)):_.push(u&&u.raw?T:T.value):_.push(void 0);return _}return"number"==typeof E.expires&&Date.now()>E.expires?this.delete(y).then(()=>{}):u&&u.raw?E:E.value}})}set(y,u,p){const O=this._getKeyPrefix(y);void 0===p&&(p=this.opts.ttl),0===p&&(p=void 0);const{store:A}=this.opts;return Promise.resolve().then(()=>{const E="number"==typeof p?Date.now()+p:null;return"symbol"==typeof u&&this.emit("error","symbol cannot be serialized"),this.opts.serialize(u={value:u,expires:E})}).then(E=>A.set(O,E,p)).then(()=>!0)}delete(y){const{store:u}=this.opts;if(Array.isArray(y)){const O=this._getKeyPrefixArray(y);if(void 0===u.deleteMany){const A=[];for(const E of O)A.push(u.delete(E));return Promise.allSettled(A).then(E=>E.every(_=>!0===_.value))}return Promise.resolve().then(()=>u.deleteMany(O))}const p=this._getKeyPrefix(y);return Promise.resolve().then(()=>u.delete(p))}clear(){const{store:y}=this.opts;return Promise.resolve().then(()=>y.clear())}has(y){const u=this._getKeyPrefix(y),{store:p}=this.opts;return Promise.resolve().then(n(function*(){return"function"==typeof p.has?p.has(u):void 0!==(yield p.get(u))}))}disconnect(){const{store:y}=this.opts;if("function"==typeof y.disconnect)return y.disconnect()}}},3196:h=>{function g(i){var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}g.keys=()=>[],g.resolve=g,g.id=3196,h.exports=g},5503:(h,g,i)=>{"use strict";function n(d){this.wrapped=d}i.d(g,{Z:()=>n})},9036:(h,g,i)=>{"use strict";function n(t){var e,r,c,w=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,c=Symbol.iterator);w--;){if(r&&null!=(e=t[r]))return e.call(t);if(c&&null!=(e=t[c]))return new d(e.call(t));r="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function d(t){function e(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var c=r.done;return Promise.resolve(r.value).then(function(w){return{value:w,done:c}})}return(d=function(c){this.s=c,this.n=c.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(c){var w=this.s.return;return void 0===w?Promise.resolve({value:c,done:!0}):e(w.apply(this.s,arguments))},throw:function(c){var w=this.s.return;return void 0===w?Promise.reject(c):e(w.apply(this.s,arguments))}},new d(t)}i.d(g,{Z:()=>n})},1694:(h,g,i)=>{"use strict";i.d(g,{Z:()=>d});var n=i(5503);function d(t){return new n.Z(t)}},2452:(h,g,i)=>{"use strict";i.d(g,{Z:()=>t});var n=i(5503);function d(e){var r,c;function b(P,y){try{var u=e[P](y),p=u.value,O=p instanceof n.Z;Promise.resolve(O?p.wrapped:p).then(function(A){O?b("return"===P?"return":"next",A):D(u.done?"return":"normal",A)},function(A){b("throw",A)})}catch(A){D("throw",A)}}function D(P,y){switch(P){case"return":r.resolve({value:y,done:!0});break;case"throw":r.reject(y);break;default:r.resolve({value:y,done:!1})}(r=r.next)?b(r.key,r.arg):c=null}this._invoke=function(P,y){return new Promise(function(u,p){var O={key:P,arg:y,resolve:u,reject:p,next:null};c?c=c.next=O:(r=c=O,b(P,y))})},"function"!=typeof e.return&&(this.return=void 0)}function t(e){return function(){return new d(e.apply(this,arguments))}}d.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},d.prototype.next=function(e){return this._invoke("next",e)},d.prototype.throw=function(e){return this._invoke("throw",e)},d.prototype.return=function(e){return this._invoke("return",e)}},1103:(h,g,i)=>{"use strict";i.a(h,async n=>{i.d(g,{EN:()=>k});var E,d=i(9671),t=i(9036),e=i(1694),r=i(2452),c=i(5048),w=i(5700),b=i(7715),D=i(6886),P=i(451),y=i(7110),u=n([P]),p=(0,(P=(u.then?await u:u)[0]).iw)("cl100k_base"),A=class extends Error{};E||(E={});var _=globalThis.fetch;function T(U){return a.apply(this,arguments)}function a(){return(a=(0,r.Z)(function*(U){const K=U.getReader();try{for(;;){const{done:S,value:G}=yield(0,e.Z)(K.read());if(S)return;yield G}}finally{K.releaseLock()}})).apply(this,arguments)}function o(){return(o=(0,d.Z)(function*(U,K,S=_){const v=K,{onMessage:G}=v,V=le(v,["onMessage"]),B=yield S(U,V);if(!B.ok){let x;try{x=yield B.text()}catch(R){x=B.statusText}const M=new A(`ChatGPT error ${B.status}: ${x}`,{cause:B});throw M.statusCode=B.status,M.statusText=B.statusText,M}const $=(0,y.j)(x=>{"event"===x.type&&G(x.data)});if(B.body.getReader){var F,J=!1,Z=!1;try{for(var f,l=(0,t.Z)(T(B.body));J=!(f=yield l.next()).done;J=!1){const x=f.value,L=(new TextDecoder).decode(x);$.feed(L)}}catch(x){Z=!0,F=x}finally{try{J&&null!=l.return&&(yield l.return())}finally{if(Z)throw F}}}else{const x=B.body;if(!x.on||!x.read)throw new A('unsupported "fetch" implementation');x.on("readable",()=>{let L;for(;null!==(L=x.read());)$.feed(L.toString())})}})).apply(this,arguments)}var k=class{constructor(U){const{apiKey:K,apiBaseUrl:S="https://api.openai.com/v1",debug:G=!1,messageStore:V,completionParams:B,systemMessage:$,maxModelTokens:J=4e3,maxResponseTokens:Z=1e3,getMessageById:F,upsertMessage:l,fetch:f=_}=U;if(this._apiKey=K,this._apiBaseUrl=S,this._debug=!!G,this._fetch=f,this._completionParams=te({model:"gpt-3.5-turbo",temperature:.8,top_p:1,presence_penalty:1},B),this._systemMessage=$,void 0===this._systemMessage){const v=(new Date).toISOString().split("T")[0];this._systemMessage=`You are ChatGPT, a large language model trained by OpenAI. Answer as concisely as possible.\nKnowledge cutoff: 2021-09-01\nCurrent date: ${v}`}if(this._maxModelTokens=J,this._maxResponseTokens=Z,this._getMessageById=null!=F?F:this._defaultGetMessageById,this._upsertMessage=null!=l?l:this._defaultUpsertMessage,this._messageStore=V||new c({store:new b.Z({maxSize:1e4})}),!this._apiKey)throw new Error("OpenAI missing required apiKey");if(!this._fetch)throw new Error("Invalid environment; fetch is not defined");if("function"!=typeof this._fetch)throw new Error('Invalid "fetch" is not a function')}sendMessage(U,K={}){var S=this;return(0,d.Z)(function*(){const{parentMessageId:G,messageId:V=(0,D.Z)(),timeoutMs:B,onProgress:$,stream:J=!!$,completionParams:Z}=K;let{abortSignal:F}=K,l=null;B&&!F&&(l=new AbortController,F=l.signal);const f={role:"user",id:V,parentMessageId:G,text:U};yield S._upsertMessage(f);const{messages:v,maxTokens:x,numTokens:L}=yield S._buildMessages(U,K),M={role:"assistant",id:(0,D.Z)(),parentMessageId:V,text:""},R=new Promise(function(){var N=(0,d.Z)(function*(z,j){var ne,re;const q=`${S._apiBaseUrl}/chat/completions`,se={"Content-Type":"application/json",Authorization:`Bearer ${S._apiKey}`},ie=ue(te(te({max_tokens:x},S._completionParams),Z),{messages:v,stream:J});if(S._debug&&console.log(`sendMessage (${L} tokens)`,ie),J)(function(U,K){return o.apply(this,arguments)})(q,{method:"POST",headers:se,body:JSON.stringify(ie),signal:F,onMessage:H=>{var Q;if("[DONE]"===H)return M.text=M.text.trim(),z(M);try{const W=JSON.parse(H);if(W.id&&(M.id=W.id),null==(Q=null==W?void 0:W.choices)?void 0:Q.length){const ee=W.choices[0].delta;M.delta=ee.content,(null==ee?void 0:ee.content)&&(M.text+=ee.content),M.detail=W,ee.role&&(M.role=ee.role),null==$||$(M)}}catch(W){return console.warn("OpenAI stream SEE event unexpected error",W),j(W)}}},S._fetch).catch(j);else try{const H=yield S._fetch(q,{method:"POST",headers:se,body:JSON.stringify(ie),signal:F});if(!H.ok){const W=yield H.text(),ce=new A(`OpenAI error ${H.status||H.statusText}: ${W}`,{cause:H});return ce.statusCode=H.status,ce.statusText=H.statusText,j(ce)}const Q=yield H.json();if(S._debug&&console.log(Q),(null==Q?void 0:Q.id)&&(M.id=Q.id),!(null==(ne=null==Q?void 0:Q.choices)?void 0:ne.length)){const W=Q;return j(new Error(`OpenAI error: ${(null==(re=null==W?void 0:W.detail)?void 0:re.message)||(null==W?void 0:W.detail)||"unknown"}`))}{const W=Q.choices[0].message;M.text=W.content,W.role&&(M.role=W.role)}return M.detail=Q,z(M)}catch(H){return j(H)}});return function(z,j){return N.apply(this,arguments)}}()).then(N=>S._upsertMessage(N).then(()=>N));return B?(l&&(R.cancel=()=>{l.abort()}),(0,w.ZP)(R,{milliseconds:B,message:"OpenAI timed out waiting for response"})):R})()}get apiKey(){return this._apiKey}set apiKey(U){this._apiKey=U}_buildMessages(U,K){var S=this;return(0,d.Z)(function*(){const{systemMessage:G=S._systemMessage}=K;let{parentMessageId:V}=K;const J=S._maxModelTokens-S._maxResponseTokens;let Z=[];G&&Z.push({role:"system",content:G});const F=Z.length;let l=U?Z.concat([{role:"user",content:U,name:K.name}]):Z,f=0;for(;;){const x=l.reduce((z,j)=>{switch(j.role){case"system":return z.concat([`Instructions:\n${j.content}`]);case"user":return z.concat([`User:\n${j.content}`]);default:return z.concat([`ChatGPT:\n${j.content}`])}},[]).join("\n\n"),L=yield S._getTokenCount(x),M=L<=J;if(x&&!M||(Z=l,f=L,!M)||!V)break;const R=yield S._getMessageById(V);if(!R)break;const N=R.role||"user";l=l.slice(0,F).concat([{role:N,content:R.text,name:R.name},...l.slice(F)]),V=R.parentMessageId}return{messages:Z,maxTokens:Math.max(1,Math.min(S._maxModelTokens-f,S._maxResponseTokens)),numTokens:f}})()}_getTokenCount(U){return(0,d.Z)(function*(){return function(U){return p.encode(U)}(U=U.replace(/<\|endoftext\|>/g,"")).length})()}_defaultGetMessageById(U){var K=this;return(0,d.Z)(function*(){return yield K._messageStore.get(U)})()}_defaultUpsertMessage(U){var K=this;return(0,d.Z)(function*(){yield K._messageStore.set(U.id,U)})()}}})},5700:(h,g,i)=>{"use strict";i.d(g,{ZP:()=>c});var n=i(9671);class d extends Error{constructor(b){super(b),this.name="TimeoutError"}}class t extends Error{constructor(b){super(),this.name="AbortError",this.message=b}}const e=w=>void 0===globalThis.DOMException?new t(w):new DOMException(w),r=w=>{const b=void 0===w.reason?e("This operation was aborted."):w.reason;return b instanceof Error?b:e(b)};function c(w,b){const{milliseconds:D,fallback:P,message:y,customTimers:u={setTimeout,clearTimeout}}=b;let p;const O=new Promise((A,E)=>{if("number"!=typeof D||1!==Math.sign(D))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${D}\``);if(D===Number.POSITIVE_INFINITY)return void A(w);if(b.signal){const{signal:T}=b;T.aborted&&E(r(T)),T.addEventListener("abort",()=>{E(r(T))})}const _=new d;p=u.setTimeout.call(void 0,()=>{if(P)try{A(P())}catch(T){E(T)}else"function"==typeof w.cancel&&w.cancel(),!1===y?A():y instanceof Error?E(y):(_.message=null!=y?y:`Promise timed out after ${D} milliseconds`,E(_))},D),(0,n.Z)(function*(){try{A(yield w)}catch(T){E(T)}finally{u.clearTimeout.call(void 0,p)}})()});return O.clear=()=>{u.clearTimeout.call(void 0,p),p=void 0},O}},7110:(h,g,i)=>{"use strict";function n(e){let r,c,w,b,D,P,y;return u(),{feed:function(A){c=c?c+A:A,r&&function(e){return d.every((r,c)=>e.charCodeAt(c)===r)}(c)&&(c=c.slice(d.length)),r=!1;const E=c.length;let _=0,T=!1;for(;_<E;){T&&("\n"===c[_]&&++_,T=!1);let o,a=-1,s=b;for(let m=w;a<0&&m<E;++m)o=c[m],":"===o&&s<0?s=m-_:"\r"===o?(T=!0,a=m-_):"\n"===o&&(a=m-_);if(a<0){w=E-_,b=s;break}w=0,b=-1,O(c,_,s,a),_+=a+1}_===E?c="":_>0&&(c=c.slice(_))},reset:u};function u(){r=!0,c="",w=0,b=-1,D=void 0,P=void 0,y=""}function O(A,E,_,T){if(0===T)return y.length>0&&(e({type:"event",id:D,event:P||void 0,data:y.slice(0,-1)}),y="",D=void 0),void(P=void 0);const a=_<0,s=A.slice(E,E+(a?T:_));let o=0;o=a?T:" "===A[E+_+1]?_+2:_+1;const m=E+o,C=A.slice(m,m+(T-o)).toString();if("data"===s)y+=C?"".concat(C,"\n"):"\n";else if("event"===s)P=C;else if("id"!==s||C.includes("\0")){if("retry"===s){const k=parseInt(C,10);Number.isNaN(k)||e({type:"reconnect-interval",value:k})}}else D=C}}i.d(g,{j:()=>n});const d=[239,187,191]},7715:(h,g,i)=>{"use strict";i.d(g,{Z:()=>n});class n extends Map{constructor(t={}){if(super(),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof t.maxAge&&0===t.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=t.maxSize,this.maxAge=t.maxAge||Number.POSITIVE_INFINITY,this.onEviction=t.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(t){if("function"==typeof this.onEviction)for(const[e,r]of t)this.onEviction(e,r.value)}_deleteIfExpired(t,e){return"number"==typeof e.expiry&&e.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(t,e.value),this.delete(t))}_getOrDeleteIfExpired(t,e){if(!1===this._deleteIfExpired(t,e))return e.value}_getItemValue(t,e){return e.expiry?this._getOrDeleteIfExpired(t,e):e.value}_peek(t,e){const r=e.get(t);return this._getItemValue(t,r)}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(t,e){this.oldCache.delete(t),this._set(t,e)}*_entriesAscending(){for(const t of this.oldCache){const[e,r]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,r)&&(yield t)}for(const t of this.cache){const[e,r]=t;!1===this._deleteIfExpired(e,r)&&(yield t)}}get(t){if(this.cache.has(t)){const e=this.cache.get(t);return this._getItemValue(t,e)}if(this.oldCache.has(t)){const e=this.oldCache.get(t);if(!1===this._deleteIfExpired(t,e))return this._moveToRecent(t,e),e.value}}set(t,e,{maxAge:r=this.maxAge}={}){const c="number"==typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(t)?this.cache.set(t,{value:e,expiry:c}):this._set(t,{value:e,expiry:c})}has(t){return this.cache.has(t)?!this._deleteIfExpired(t,this.cache.get(t)):!!this.oldCache.has(t)&&!this._deleteIfExpired(t,this.oldCache.get(t))}peek(t){return this.cache.has(t)?this._peek(t,this.cache):this.oldCache.has(t)?this._peek(t,this.oldCache):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...this._entriesAscending()],r=e.length-t;r<0?(this.cache=new Map(e),this.oldCache=new Map,this._size=e.length):(r>0&&this._emitEvictions(e.slice(0,r)),this.oldCache=new Map(e.slice(r)),this.cache=new Map,this._size=0),this.maxSize=t}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache){const[e,r]=t;!1===this._deleteIfExpired(e,r)&&(yield[e,r.value])}for(const t of this.oldCache){const[e,r]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,r)&&(yield[e,r.value])}}*entriesDescending(){let t=[...this.cache];for(let e=t.length-1;e>=0;--e){const r=t[e],[c,w]=r;!1===this._deleteIfExpired(c,w)&&(yield[c,w.value])}t=[...this.oldCache];for(let e=t.length-1;e>=0;--e){const r=t[e],[c,w]=r;this.cache.has(c)||!1===this._deleteIfExpired(c,w)&&(yield[c,w.value])}}*entriesAscending(){for(const[t,e]of this._entriesAscending())yield[t,e.value]}get size(){if(!this._size)return this.oldCache.size;let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return Math.min(this._size+t,this.maxSize)}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[r,c]of this.entriesAscending())t.call(e,c,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}},684:(h,g,i)=>{"use strict";var n=i(952);h.exports=i.v(g,h.id,"40beb033492cf631",{"./tiktoken_bg.js":{__wbindgen_object_drop_ref:n.ug,__wbindgen_is_undefined:n.XP,__wbg_stringify_029a979dfb73aa17:n.YP,__wbindgen_string_get:n.qt,__wbindgen_error_new:n.hd,__wbg_parse_3ac95b51fc312db8:n.FO,__wbindgen_throw:n.Or}})}}]);